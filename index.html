<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <link href="style.css" rel="stylesheet" />

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@300&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Sigmar+One&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Dosis:wght@200..800&family=Sigmar+One&display=swap" rel="stylesheet" />

    <script src="https://cdn.plot.ly/plotly-2.30.1.min.js" charset="utf-8"></script>

    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.1/addons/p5.sound.min.js"></script>-->

    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.45/Tone.js"></script>
  </head>
  <body>
    <header>
      <title id="title">Ear2Earth</title>
      <h2>Ear2Earth, Environmental Sensor Data Sonification Platform</h2>
    </header>

    <main>
      <!-- === Top Menu (Dataset + Playback) ================================= -->
      <div class="topmenu">
        <!-- Left: Dataset toolbar -->
        <section class="toolbar toolbar-data" aria-label="Dataset & retrieval">
          <div class="row">

            <!-- Preset -->
            <div class="group">
              <label class="u-sr-only" for="retrieveByNameDropdown">Preset</label>
              <select id="retrieveByNameDropdown">
                <option value="default" id="default_preset">Select a Preset</option>
              </select>
            </div>

            <!-- Collapsible Database/Device (kept for index.js; starts hidden) -->
            <button class="icon-btn collapse-btn" id="toggleDataSource" title="Show databases & devices">▼</button>
            <div id="dataSource" style="display:none">
              <div id="databaseElements">
                <label for="databases">Database:</label>
                <select id="databases">
                  <option value="default">Select a database</option>
                </select>
              </div>
              <div id="deviceElements">
                <label for="devices">Device:</label>
                <select id="devices">
                  <option value="default">Select a device</option>
                </select>
              </div>
            </div>

            <!-- Packet option radios (required by index.js, so kept for now as well) -->
            <div class="group" id="dataOptions">
              <label>
                <input type="radio" id="lastXPackets" name="packetOption" value="lastXPackets" checked />
                Last X Packets
              </label>
              <label>
                <input type="radio" id="timeRange" name="packetOption" value="timeRange" />
                Time Range
              </label>
            </div>
            
            <!--Test-->

            <!-- # Packets -->
            <div class="group" id="numpacketsInput">
              <label for="numpackets"># Packets</label>
              <input type="text" id="numpackets" name="numpackets" value="16" />
            </div>

            <!-- Prescaler -->
            <div class="group" id="skipPackets">
              <span class="muted">Use 1 of every</span>
              <input type="number" id="prescaler" name="prescaler" value="1" />
              <span class="muted">packets</span>
            </div>

            <!-- Time range (kept with exact ID for index.js; calendar picker) -->
            <div class="group time" id="timeInputs" style="display:none">
              <span class="muted">Time Range</span>
              <input type="date" id="startTime" />
              <span class="muted">–</span>
              <input type="date" id="endTime" />
            </div>

            <!-- Retrieve -->
            <button id="retrieve" class="primary-btn">Retrieve Data</button>

            <!-- Info / Metadata -->
            <div class="group">
              <button id="infoButton" class="icon-btn" title="Help"></button>
              <button id="metadataButton" class="pill-btn">View Metadata</button>
            </div>
          </div>
        </section>

        <!-- Right: Playback toolbar -->
        <section class="toolbar toolbar-transport" aria-label="Playback">
          <div class="row">
            <div class="transport-group">
              <button id="play" class="square-btn" title="Play"></button>
              <button id="stop" class="square-btn" title="Stop"></button>
            </div>

            <div id="bpmContainer" class="transport-group">
              <label id="bpmLabel" for="bpm">BPM</label>
              <input type="range" id="bpm" name="bpm" min="50" max="200" />
              <div id="bpmText">125</div>

              <!-- Speed options (IDs required by index.js) -->
              <div id="speedOptions" class="speed">
                <label for="speed1x">1x</label>
                <input type="radio" id="speed1x" name="speed" value="1" checked />
                <label for="speed2x">2x</label>
                <input type="radio" id="speed2x" name="speed" value="2" />
                <label for="speed4x">4x</label>
                <input type="radio" id="speed4x" name="speed" value="4" />
                <label for="speed8x">8x</label>
                <input type="radio" id="speed8x" name="speed" value="8" />
              </div>
            </div>
          </div>
        </section>
      </div>
      <!-- =================================================================== -->

      <div id="modulesContainer"></div>
      <button id="addModule"></button>
    </main>

    <script type="module" src="index.js"></script>
  </body>
</html>
